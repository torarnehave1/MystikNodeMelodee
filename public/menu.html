<!-- menu.html -->
<div class="container-fluid" style="background-color: #FFCC99;">
    <header class="d-flex flex-wrap align-items-center justify-content-between py-3 mb-4 border-bottom">
        <div class="d-flex align-items-center">
            <div class="me-4">
                <a href="/" class="d-inline-flex link-body-emphasis text-decoration-none">
                    <svg class="bi" width="40" height="32" role="img" aria-label="Bootstrap"><use xlink:href="#bootstrap"/></svg>
                </a>
            </div>
            <div class="text-left my-2">
                <span class="display-8 fw-bold" id="titlelanguage">Language:</span>
                <select id="languageSelector" class="form-control w-50 d-inline" title="Select Language">
                    <option value="en">English</option>
                    <option value="es">Español</option>
                    <option value="nb">Norsk</option>
                    <option value="tr">Türkçe</option>
                </select>
            </div>
        </div>
        
        <ul class="nav col-12 col-md-auto mb-2 justify-content-center mb-md-0">
            <li><a href="../index.html" class="nav-link px-2 link-secondary" id="navHome">Home</a></li>
            <li><a href="#" class="nav-link px-2" id="navFeatures">Features</a></li>
            <li><a href="#" class="nav-link px-2" id="navPricing">Pricing</a></li>
            <li><a href="#" class="nav-link px-2" id="navFAQs">FAQs</a></li>
            <li><a href="#" class="nav-link px-2" id="navAbout">About</a></li>
        </ul>
        
        <div class="text-end" id="auth-buttons">
            <a href="../login.html"><button type="button" class="btn btn-outline-primary me-2" id="loginButton">Login</button></a>
            <a href="../reg.html"><button type="button" class="btn btn-primary" id="signupButton">Sign-up</button></a>
        </div>
        <div class="text-end d-none" id="logout-button">
            <button type="button" class="btn btn-primary" id="logoutButton">Logout</button>
        </div>
    </header>
</div>

<script>
    function loadLanguage(language) {
        fetch(`/languages/${language}.json`)
            .then(response => response.json())
            .then(data => {
                document.getElementById('navHome').innerText = data.navHome;
                document.getElementById('navFeatures').innerText = data.navFeatures;
                document.getElementById('navPricing').innerText = data.navPricing;
                document.getElementById('navFAQs').innerText = data.navFAQs;
                document.getElementById('navAbout').innerText = data.navAbout;
                document.getElementById('loginButton').innerText = data.loginButton;
                document.getElementById('signupButton').innerText = data.signupButton;
                document.getElementById('titlelanguage').innerText = data.titlelanguage;
            });
    }

    function initializeLanguageSelector() {
        console.log("Initializing language selector");
        document.getElementById('languageSelector').addEventListener('change', function() {
            const selectedLanguage = this.value;
            localStorage.setItem('preferredLanguage', selectedLanguage);
            loadLanguage(selectedLanguage);
        });

        const preferredLanguage = localStorage.getItem('preferredLanguage') || 'en';
        document.getElementById('languageSelector').value = preferredLanguage;
        loadLanguage(preferredLanguage);
    }

    function getCookie(name) {
        const value = `; ${document.cookie}`;
        const parts = value.split(`; ${name}=`);
        if (parts.length === 2) return parts.pop().split(';').shift();
    }

    function checkAuthStatus() {
        console.log("Checking auth status");
        const token = getCookie('jwtToken');
        console.log('Token found:', token);

        if (token) {
            document.getElementById('auth-buttons').classList.add('d-none');
            document.getElementById('logout-button').classList.remove('d-none');
        } else {
            document.getElementById('auth-buttons').classList.remove('d-none');
            document.getElementById('logout-button').classList.add('d-none');
        }

        document.getElementById('logoutButton').addEventListener('click', () => {
            document.cookie = 'jwtToken=; Max-Age=0'; // Clear the cookie
            location.reload();
        });
    }

    document.addEventListener('DOMContentLoaded', () => {
        console.log("DOM fully loaded and parsed");
        initializeLanguageSelector();
        checkAuthStatus();
        console.log("Checking auth status");
    });
</script>

